import{a as y}from"./axios-G2rPRu76.js";import{_ as C,h as v,o as u,c as m,b as t,i as c,d as n,g as I,r as d,a as L,m as j,F as $,j as R,k as V}from"./index-KgTiI9a3.js";import{P as D}from"./PaginationComponent-AAERBtCd.js";import{M as B}from"./modal-CLS8snV1.js";import{w as N}from"./index-_3WxGp7i.js";const T={props:{item:{type:Object,default(){return{}}}},data(){return{modal:""}},components:{Warning:N},mounted(){this.modal=new B(this.$refs.modalRef)},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}}},W={class:"modal fade",id:"deleteItemModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modalRef"},F={class:"modal-dialog modal-xl",role:"document"},A={class:"modal-content border-0"},E=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{class:"modal-title",id:"exampleModalLabel"}," 您即將刪除 "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),G={class:"modal-body"},O=t("h4",{class:"opacity-50"},"刪除後將無法復原，請務必確認!",-1),S={class:"modal-footer"},q=t("button",{type:"button",class:"btn btn-grey66","data-bs-dismiss":"modal"},"取消",-1);function z(f,i,l,p,_,r){const s=v("Warning");return u(),m("div",W,[t("div",F,[t("div",A,[E,t("div",G,[c(s,{style:{width:"150px",height:"150px",color:"#fde4b4"}}),t("h3",null,'確定要刪除"'+n(l.item.title)+'"嗎?',1),O]),t("div",S,[t("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:i[0]||(i[0]=h=>f.$emit("deleteItem",l.item.id))},"確定刪除"),q])])])],512)}const H=C(T,[["render",z]]),J={class:"container my-5 text-center"},K={class:"text-start mb-5 d-flex justify-content-between"},Q=t("h3",null,"商品列表",-1),U={class:"btn btn-outline-primary"},X={class:"table align-middle"},Y=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"品名"),t("th",{scope:"col"},"分類"),t("th",{scope:"col"},"價格"),t("th",{scope:"col"},"特價"),t("th",{scope:"col"},"成分"),t("th",{scope:"col"},"是否啟用")])],-1),Z={scope:"row"},tt=["onClick"],et=["onClick"],dt={__name:"AdminProducts",setup(f){const i=I(),l=d([]),p=d(""),_=d(""),r=d({}),s=d(!1),h=d(),b=(e=1)=>{s.value=!0,y.get(`https://vue3-course-api.hexschool.io/v2/api/jeremychan/admin/products?page=${e}`).then(a=>{l.value=a.data.products,p.value=a.data.pagination.total_pages,_.value=a.data.pagination.current_page}).catch(a=>alert(a.response.data.message)).finally(()=>{s.value=!1})},x=e=>{const a=l.value.find(g=>g.id===e);r.value=a,h.value.openModal()},M=e=>{i.push(`/admin/edit-product/${e}`)},k=async()=>{s.value=!0;try{const e=await y.delete(`https://vue3-course-api.hexschool.io/v2/api/jeremychan/admin/product/${r.value.id}`);alert(`${e.data.message}`),b()}catch(e){alert(e.data.message)}s.value=!1};return L(()=>{b()}),(e,a)=>{const g=v("loadingVue"),P=v("RouterLink");return u(),m($,null,[c(g,{active:s.value},null,8,["active"]),t("section",J,[t("div",K,[Q,t("button",U,[c(P,{class:"navbar-brand",to:"/admin/add-product"},{default:j(()=>[V(" 新增商品 ")]),_:1})])]),t("table",X,[Y,t("tbody",null,[(u(!0),m($,null,R(l.value,o=>(u(),m("tr",{key:o.id},[t("th",Z,n(o.title),1),t("td",null,n(o.category),1),t("td",null,n(o.origin_price),1),t("td",null,n(o.price),1),t("td",null,n(o.content),1),t("td",null,n(o.is_enabled?"是":"否"),1),t("td",null,[t("button",{onClick:w=>M(o.id),type:"button",class:"btn btn-primary"},"編輯",8,tt)]),t("td",null,[t("button",{onClick:w=>x(o.id),type:"button",class:"btn btn-outline-danger"},"刪除",8,et)])]))),128))])])]),c(D,{currentPage:_.value,totalPages:p.value,onGoToPage:b},null,8,["currentPage","totalPages"]),c(H,{ref_key:"deleteItemModal",ref:h,item:r.value,onDeleteItem:k},null,8,["item"])],64)}}};export{dt as default};
