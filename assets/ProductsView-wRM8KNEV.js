import{a as f}from"./axios-G2rPRu76.js";import{r as n,t as P,a as C,w as V,o as d,c,b as t,d as l,u as x,e as _,f as R,v as j,_ as L,g as S,h as T,i as M,F as w,j as B,n as N,k as I,p as U,l as z}from"./index-MOUAHhhC.js";import{M as D}from"./modal-wmBw_mPt.js";const F={class:"modal-dialog modal-xl",role:"document"},q={class:"modal-content border-0"},A={class:"modal-header bg-dark text-white"},E={class:"modal-title",id:"exampleModalLabel"},O=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),G={class:"modal-body"},H={class:"row"},J={class:"col-sm-6"},K=["src"],Q={class:"col-sm-6"},W={class:"badge bg-primary rounded-pill"},X={key:0,class:"h5"},Y={key:1,class:"h6"},Z={key:2,class:"h5"},tt={class:"input-group"},et={__name:"UserProductModal",props:{product:{type:Object,default(){return{}}}},emits:["add-to-cart"],setup(i,{expose:b,emit:h}){const e=i,g=h,v=n(null),r=n(null),u=n(1),{product:m}=P(e);return b({openModal:()=>{r.value.show()},hideModal:()=>{r.value.hide()}}),C(()=>{r.value=new D(v.value,{keyboard:!1,backdrop:"static"})}),V(m,()=>u.value=1),(s,a)=>(d(),c("div",{class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref_key:"modalRef",ref:v},[t("div",F,[t("div",q,[t("div",A,[t("h5",E,[t("span",null,l(e.product.title),1)]),O]),t("div",G,[t("div",H,[t("div",J,[t("img",{class:"img-fluid",src:e.product.imgUrl,alt:""},null,8,K)]),t("div",Q,[t("span",W,l(e.product.category),1),t("p",null,"商品描述："+l(e.product.description),1),t("p",null,"商品內容："+l(x(m).content),1),x(m).price?_("",!0):(d(),c("div",X,l(e.product.origin_price)+" 元 ",1)),e.product.price?(d(),c("del",Y,"原價 "+l(e.product.origin_price)+" 元",1)):_("",!0),e.product.price?(d(),c("div",Z," 現在只要 "+l(e.product.price)+" 元 ",1)):_("",!0),t("div",null,[t("div",tt,[R(t("input",{type:"number",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=p=>u.value=p),min:"1"},null,512),[[j,u.value,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:a[1]||(a[1]=p=>g("add-to-cart",e.product.id,u.value))}," 加入購物車 ")])])])])])])])],512))}},ot=i=>(U("data-v-ca65dd38"),i=i(),z(),i),st={class:"container"},at={class:"mt-4"},lt={class:"table align-middle"},dt=ot(()=>t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1)),ct={style:{width:"200px"}},nt=["onClick"],rt={key:0,class:"h5"},it={class:"h6"},ut={class:"h5"},pt={class:"btn-group btn-group-sm"},_t=["onClick"],ht={key:0,class:"fas fa-spinner fa-pulse"},vt=["onClick"],mt={key:0,class:"fas fa-spinner fa-pulse"},gt={__name:"ProductsView",setup(i){const b=S(),h=n(null),e=n({loadingItem:""}),g=n([]),v=n({}),r=n(!1),u=async()=>{r.value=!0;try{const s=await f.get("https://vue3-course-api.hexschool.io/v2/api/jeremychan/products/all");g.value=s.data.products}catch(s){alert(s.response.data.message)}r.value=!1},m=async s=>{try{e.value.loadingItem=s;const a=await f.get(`https://vue3-course-api.hexschool.io/v2/api/jeremychan/product/${s}`);e.value.loadingItem="",v.value=a.data.product,h.value.openModal()}catch(a){alert(a.response.data.message)}},y=async(s,a=1)=>{e.value.loadingItem=s;const p={product_id:s,qty:a};try{const o=await f.post("https://vue3-course-api.hexschool.io/v2/api/jeremychan/cart",{data:p});alert(o.data.message),e.value.loadingItem="",h.value.hideModal()}catch(o){alert(o.response.data.message)}},$=s=>{b.push(`/product/${s}`)};return C(async()=>{await u()}),(s,a)=>{const p=T("loadingVue");return d(),c(w,null,[M(p,{active:r.value},null,8,["active"]),t("div",st,[t("div",at,[M(et,{ref_key:"userProductModalRef",ref:h,product:v.value,onAddToCart:y},null,8,["product"]),t("table",lt,[dt,t("tbody",null,[(d(!0),c(w,null,B(g.value,o=>(d(),c("tr",{key:o.id,class:"item"},[t("td",ct,[t("div",{onClick:k=>$(o.id),style:N([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${o.imgUrl})`}])},null,12,nt)]),t("td",null,[o.price?_("",!0):(d(),c("div",rt,l(o.origin_price)+" 元 ",1)),t("del",it,"原價 "+l(o.origin_price)+" 元",1),t("div",ut,"現在只要 "+l(o.price)+" 元",1)]),t("td",null,[t("div",pt,[t("button",{onClick:k=>m(o.id),type:"button",class:"btn btn-outline-secondary"},[e.value.loadingItem===o.id?(d(),c("i",ht)):_("",!0),I(" 查看更多 ")],8,_t),t("button",{onClick:k=>y(o.id),type:"button",class:"btn btn-outline-danger"},[e.value.loadingItem===o.id?(d(),c("i",mt)):_("",!0),I(" 加到購物車 ")],8,vt)])])]))),128))])])])])],64)}}},$t=L(gt,[["__scopeId","data-v-ca65dd38"]]);export{$t as default};
